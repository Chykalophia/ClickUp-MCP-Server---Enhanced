b3d3b75b18a8106fdc5aa20cd851fac3
"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const crypto_1 = __importDefault(require("crypto"));
const security_js_1 = require("../utils/security.js");
(0, globals_1.describe)('Security Utilities', () => {
    (0, globals_1.beforeEach)(() => {
        // Reset rate limiter before each test
        security_js_1.rateLimiter.reset();
    });
    (0, globals_1.describe)('validateApiToken', () => {
        (0, globals_1.it)('should validate correct API token', () => {
            const result = (0, security_js_1.validateApiToken)('pk_1234567890abcdef');
            (0, globals_1.expect)(result.isValid).toBe(true);
            (0, globals_1.expect)(result.error).toBeUndefined();
        });
        (0, globals_1.it)('should reject empty token', () => {
            const result = (0, security_js_1.validateApiToken)('');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('API token is required');
        });
        (0, globals_1.it)('should reject non-string token', () => {
            const result = (0, security_js_1.validateApiToken)(123);
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('API token must be a string');
        });
        (0, globals_1.it)('should reject too short token', () => {
            const result = (0, security_js_1.validateApiToken)('short');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('API token appears to be too short');
        });
        (0, globals_1.it)('should reject token with invalid characters', () => {
            const result = (0, security_js_1.validateApiToken)('token with spaces');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('API token contains invalid characters');
        });
    });
    (0, globals_1.describe)('sanitizeInput', () => {
        (0, globals_1.it)('should sanitize string input', () => {
            const input = '<script>alert("xss")</script>';
            const result = (0, security_js_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toBe('scriptalert("xss")/script');
        });
        (0, globals_1.it)('should sanitize object input', () => {
            const input = {
                name: '<script>alert("xss")</script>',
                description: 'javascript:alert("xss")'
            };
            const result = (0, security_js_1.sanitizeInput)(input);
            (0, globals_1.expect)(result.name).toBe('scriptalert("xss")/script');
            (0, globals_1.expect)(result.description).toBe('alert("xss")');
        });
        (0, globals_1.it)('should sanitize array input', () => {
            const input = ['<script>', 'javascript:alert()'];
            const result = (0, security_js_1.sanitizeInput)(input);
            (0, globals_1.expect)(result).toEqual(['script', 'alert()']);
        });
        (0, globals_1.it)('should handle non-string input', () => {
            (0, globals_1.expect)((0, security_js_1.sanitizeInput)(123)).toBe(123);
            (0, globals_1.expect)((0, security_js_1.sanitizeInput)(null)).toBe(null);
            (0, globals_1.expect)((0, security_js_1.sanitizeInput)(undefined)).toBe(undefined);
        });
    });
    (0, globals_1.describe)('validateWebhookSignature', () => {
        const secret = 'test-secret';
        const payload = '{"test": "data"}';
        (0, globals_1.it)('should validate correct signature', () => {
            const signature = crypto_1.default.createHmac('sha256', secret).update(payload).digest('hex');
            const result = (0, security_js_1.validateWebhookSignature)(payload, signature, secret);
            (0, globals_1.expect)(result.isValid).toBe(true);
            (0, globals_1.expect)(result.error).toBeUndefined();
        });
        (0, globals_1.it)('should validate signature with sha256 prefix', () => {
            const signature = crypto_1.default.createHmac('sha256', secret).update(payload).digest('hex');
            const result = (0, security_js_1.validateWebhookSignature)(payload, `sha256=${signature}`, secret);
            (0, globals_1.expect)(result.isValid).toBe(true);
        });
        (0, globals_1.it)('should reject invalid signature', () => {
            const result = (0, security_js_1.validateWebhookSignature)(payload, 'invalid-signature', secret);
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Invalid signature format');
        });
        (0, globals_1.it)('should reject missing parameters', () => {
            const result = (0, security_js_1.validateWebhookSignature)('', '', '');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Missing required parameters for signature validation');
        });
    });
    (0, globals_1.describe)('validateFileUpload', () => {
        (0, globals_1.it)('should validate safe file', () => {
            const result = (0, security_js_1.validateFileUpload)('document.pdf', 'application/pdf', 1024);
            (0, globals_1.expect)(result.isValid).toBe(true);
            (0, globals_1.expect)(result.errors).toHaveLength(0);
        });
        (0, globals_1.it)('should reject dangerous file extension', () => {
            const result = (0, security_js_1.validateFileUpload)('malware.exe');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.errors).toContain('File type not allowed for security reasons');
        });
        (0, globals_1.it)('should reject path traversal attempts', () => {
            const result = (0, security_js_1.validateFileUpload)('../../../etc/passwd');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.errors).toContain('Filename contains invalid path characters');
        });
        (0, globals_1.it)('should reject oversized files', () => {
            const result = (0, security_js_1.validateFileUpload)('large.pdf', 'application/pdf', 200 * 1024 * 1024);
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.errors).toContain('File size too large (max 104857600 bytes)');
        });
        (0, globals_1.it)('should reject disallowed mimetype', () => {
            const result = (0, security_js_1.validateFileUpload)('script.js', 'application/javascript');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.errors).toContain("Mimetype 'application/javascript' not allowed");
        });
    });
    (0, globals_1.describe)('validateUrl', () => {
        (0, globals_1.it)('should validate HTTPS URL', () => {
            const result = (0, security_js_1.validateUrl)('https://example.com/webhook');
            (0, globals_1.expect)(result.isValid).toBe(true);
            (0, globals_1.expect)(result.error).toBeUndefined();
        });
        (0, globals_1.it)('should validate HTTP URL', () => {
            const result = (0, security_js_1.validateUrl)('http://example.com/webhook');
            (0, globals_1.expect)(result.isValid).toBe(true);
        });
        (0, globals_1.it)('should reject non-HTTP protocols', () => {
            const result = (0, security_js_1.validateUrl)('ftp://example.com/file');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Only HTTP and HTTPS URLs are allowed');
        });
        (0, globals_1.it)('should reject localhost URLs', () => {
            const result = (0, security_js_1.validateUrl)('http://localhost:3000/webhook');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Private and localhost URLs are not allowed');
        });
        (0, globals_1.it)('should reject private IP addresses', () => {
            const result = (0, security_js_1.validateUrl)('http://192.168.1.1/webhook');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Private and localhost URLs are not allowed');
        });
        (0, globals_1.it)('should reject invalid URL format', () => {
            const result = (0, security_js_1.validateUrl)('not-a-url');
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.error).toBe('Invalid URL format');
        });
    });
    (0, globals_1.describe)('generateSecureToken', () => {
        (0, globals_1.it)('should generate token of correct length', () => {
            const token = (0, security_js_1.generateSecureToken)(16);
            (0, globals_1.expect)(token).toHaveLength(32); // 16 bytes = 32 hex chars
        });
        (0, globals_1.it)('should generate different tokens', () => {
            const token1 = (0, security_js_1.generateSecureToken)();
            const token2 = (0, security_js_1.generateSecureToken)();
            (0, globals_1.expect)(token1).not.toBe(token2);
        });
        (0, globals_1.it)('should generate hex string', () => {
            const token = (0, security_js_1.generateSecureToken)();
            (0, globals_1.expect)(/^[a-f0-9]+$/.test(token)).toBe(true);
        });
    });
    (0, globals_1.describe)('validateEnvironment', () => {
        const originalEnv = process.env;
        (0, globals_1.beforeEach)(() => {
            process.env = { ...originalEnv };
        });
        afterEach(() => {
            process.env = originalEnv;
        });
        (0, globals_1.it)('should validate with required environment variables', () => {
            process.env.CLICKUP_API_TOKEN = 'pk_1234567890abcdef';
            const result = (0, security_js_1.validateEnvironment)();
            (0, globals_1.expect)(result.isValid).toBe(true);
            (0, globals_1.expect)(result.errors).toHaveLength(0);
        });
        (0, globals_1.it)('should reject missing API token', () => {
            delete process.env.CLICKUP_API_TOKEN;
            const result = (0, security_js_1.validateEnvironment)();
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.errors).toContain('Missing required environment variable: CLICKUP_API_TOKEN');
        });
        (0, globals_1.it)('should reject invalid API token', () => {
            process.env.CLICKUP_API_TOKEN = 'invalid';
            const result = (0, security_js_1.validateEnvironment)();
            (0, globals_1.expect)(result.isValid).toBe(false);
            (0, globals_1.expect)(result.errors[0]).toContain('Invalid CLICKUP_API_TOKEN');
        });
    });
    (0, globals_1.describe)('rateLimiter', () => {
        (0, globals_1.it)('should allow requests under limit', () => {
            const config = { windowMs: 60000, maxRequests: 5 };
            for (let i = 0; i < 5; i++) {
                (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(true);
            }
        });
        (0, globals_1.it)('should reject requests over limit', () => {
            const config = { windowMs: 60000, maxRequests: 2 };
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(true);
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(true);
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(false);
        });
        (0, globals_1.it)('should reset limits after window', async () => {
            const config = { windowMs: 100, maxRequests: 1 };
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(true);
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(false);
            // Wait for window to expire
            await new Promise(resolve => setTimeout(resolve, 150));
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('test-key', config)).toBe(true);
        });
        (0, globals_1.it)('should handle different keys separately', () => {
            const config = { windowMs: 60000, maxRequests: 1 };
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('key1', config)).toBe(true);
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('key2', config)).toBe(true);
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('key1', config)).toBe(false);
            (0, globals_1.expect)(security_js_1.rateLimiter.isAllowed('key2', config)).toBe(false);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3BldGVya3J6eXplay9EZXZlbG9wbWVudC9jbGlja3VwLW1jcC1zZXJ2ZXIvc3JjL3Rlc3RzL3NlY3VyaXR5LnRlc3QudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSwyQ0FBdUU7QUFDdkUsb0RBQTRCO0FBQzVCLHNEQVM4QjtBQUU5QixJQUFBLGtCQUFRLEVBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO0lBQ2xDLElBQUEsb0JBQVUsRUFBQyxHQUFHLEVBQUU7UUFDZCxzQ0FBc0M7UUFDdEMseUJBQVcsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN0QixDQUFDLENBQUMsQ0FBQztJQUVILElBQUEsa0JBQVEsRUFBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7UUFDaEMsSUFBQSxZQUFFLEVBQUMsbUNBQW1DLEVBQUUsR0FBRyxFQUFFO1lBQzNDLE1BQU0sTUFBTSxHQUFHLElBQUEsOEJBQWdCLEVBQUMscUJBQXFCLENBQUMsQ0FBQztZQUN2RCxJQUFBLGdCQUFNLEVBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNsQyxJQUFBLGdCQUFNLEVBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsSUFBQSxZQUFFLEVBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO1lBQ25DLE1BQU0sTUFBTSxHQUFHLElBQUEsOEJBQWdCLEVBQUMsRUFBRSxDQUFDLENBQUM7WUFDcEMsSUFBQSxnQkFBTSxFQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDbkMsSUFBQSxnQkFBTSxFQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztRQUNyRCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUEsWUFBRSxFQUFDLGdDQUFnQyxFQUFFLEdBQUcsRUFBRTtZQUN4QyxNQUFNLE1BQU0s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QyxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQzFELElBQUEsZ0JBQU0sRUFBQyx5QkFBVyxDQUFDLFNBQVMsQ0FBQyxNQUFNLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDNUQsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9wZXRlcmtyenl6ZWsvRGV2ZWxvcG1lbnQvY2xpY2t1cC1tY3Atc2VydmVyL3NyYy90ZXN0cy9zZWN1cml0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlc2NyaWJlLCBpdCwgZXhwZWN0LCBiZWZvcmVFYWNoLCBqZXN0IH0gZnJvbSAnQGplc3QvZ2xvYmFscyc7XG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5pbXBvcnQge1xuICB2YWxpZGF0ZUFwaVRva2VuLFxuICBzYW5pdGl6ZUlucHV0LFxuICB2YWxpZGF0ZVdlYmhvb2tTaWduYXR1cmUsXG4gIHZhbGlkYXRlRmlsZVVwbG9hZCxcbiAgdmFsaWRhdGVVcmwsXG4gIGdlbmVyYXRlU2VjdXJlVG9rZW4sXG4gIHZhbGlkYXRlRW52aXJvbm1lbnQsXG4gIHJhdGVMaW1pdGVyXG59IGZyb20gJy4uL3V0aWxzL3NlY3VyaXR5LmpzJztcblxuZGVzY3JpYmUoJ1NlY3VyaXR5IFV0aWxpdGllcycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgLy8gUmVzZXQgcmF0ZSBsaW1pdGVyIGJlZm9yZSBlYWNoIHRlc3RcbiAgICByYXRlTGltaXRlci5yZXNldCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhdGVBcGlUb2tlbicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGNvcnJlY3QgQVBJIHRva2VuJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVBcGlUb2tlbigncGtfMTIzNDU2Nzg5MGFiY2RlZicpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZVVuZGVmaW5lZCgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZW1wdHkgdG9rZW4nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZUFwaVRva2VuKCcnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlKCdBUEkgdG9rZW4gaXMgcmVxdWlyZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IG5vbi1zdHJpbmcgdG9rZW4nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZUFwaVRva2VuKDEyMyBhcyBhbnkpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmUoJ0FQSSB0b2tlbiBtdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCB0b28gc2hvcnQgdG9rZW4nLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZUFwaVRva2VuKCdzaG9ydCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmUoJ0FQSSB0b2tlbiBhcHBlYXJzIHRvIGJlIHRvbyBzaG9ydCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgdG9rZW4gd2l0aCBpbnZhbGlkIGNoYXJhY3RlcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZUFwaVRva2VuKCd0b2tlbiB3aXRoIHNwYWNlcycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmUoJ0FQSSB0b2tlbiBjb250YWlucyBpbnZhbGlkIGNoYXJhY3RlcnMnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3Nhbml0aXplSW5wdXQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBzdHJpbmcgaW5wdXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBpbnB1dCA9ICc8c2NyaXB0PmFsZXJ0KFwieHNzXCIpPC9zY3JpcHQ+JztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhbml0aXplSW5wdXQoaW5wdXQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZSgnc2NyaXB0YWxlcnQoXCJ4c3NcIikvc2NyaXB0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHNhbml0aXplIG9iamVjdCBpbnB1dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGlucHV0ID0ge1xuICAgICAgICBuYW1lOiAnPHNjcmlwdD5hbGVydChcInhzc1wiKTwvc2NyaXB0PicsXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnamF2YXNjcmlwdDphbGVydChcInhzc1wiKSdcbiAgICAgIH07XG4gICAgICBjb25zdCByZXN1bHQgPSBzYW5pdGl6ZUlucHV0KGlucHV0KTtcbiAgICAgIGV4cGVjdChyZXN1bHQubmFtZSkudG9CZSgnc2NyaXB0YWxlcnQoXCJ4c3NcIikvc2NyaXB0Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmRlc2NyaXB0aW9uKS50b0JlKCdhbGVydChcInhzc1wiKScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBzYW5pdGl6ZSBhcnJheSBpbnB1dCcsICgpID0+IHtcbiAgICAgIGNvbnN0IGlucHV0ID0gWyc8c2NyaXB0PicsICdqYXZhc2NyaXB0OmFsZXJ0KCknXTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHNhbml0aXplSW5wdXQoaW5wdXQpO1xuICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbChbJ3NjcmlwdCcsICdhbGVydCgpJ10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbm9uLXN0cmluZyBpbnB1dCcsICgpID0+IHtcbiAgICAgIGV4cGVjdChzYW5pdGl6ZUlucHV0KDEyMykpLnRvQmUoMTIzKTtcbiAgICAgIGV4cGVjdChzYW5pdGl6ZUlucHV0KG51bGwpKS50b0JlKG51bGwpO1xuICAgICAgZXhwZWN0KHNhbml0aXplSW5wdXQodW5kZWZpbmVkKSkudG9CZSh1bmRlZmluZWQpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhdGVXZWJob29rU2lnbmF0dXJlJywgKCkgPT4ge1xuICAgIGNvbnN0IHNlY3JldCA9ICd0ZXN0LXNlY3JldCc7XG4gICAgY29uc3QgcGF5bG9hZCA9ICd7XCJ0ZXN0XCI6IFwiZGF0YVwifSc7XG4gICAgXG4gICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBjb3JyZWN0IHNpZ25hdHVyZScsICgpID0+IHtcbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGNyeXB0by5jcmVhdGVIbWFjKCdzaGEyNTYnLCBzZWNyZXQpLnVwZGF0ZShwYXlsb2FkKS5kaWdlc3QoJ2hleCcpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVXZWJob29rU2lnbmF0dXJlKHBheWxvYWQsIHNpZ25hdHVyZSwgc2VjcmV0KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc2lnbmF0dXJlIHdpdGggc2hhMjU2IHByZWZpeCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHNpZ25hdHVyZSA9IGNyeXB0by5jcmVhdGVIbWFjKCdzaGEyNTYnLCBzZWNyZXQpLnVwZGF0ZShwYXlsb2FkKS5kaWdlc3QoJ2hleCcpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVXZWJob29rU2lnbmF0dXJlKHBheWxvYWQsIGBzaGEyNTY9JHtzaWduYXR1cmV9YCwgc2VjcmV0KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGludmFsaWQgc2lnbmF0dXJlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVXZWJob29rU2lnbmF0dXJlKHBheWxvYWQsICdpbnZhbGlkLXNpZ25hdHVyZScsIHNlY3JldCk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZSgnSW52YWxpZCBzaWduYXR1cmUgZm9ybWF0Jyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBtaXNzaW5nIHBhcmFtZXRlcnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZVdlYmhvb2tTaWduYXR1cmUoJycsICcnLCAnJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZSgnTWlzc2luZyByZXF1aXJlZCBwYXJhbWV0ZXJzIGZvciBzaWduYXR1cmUgdmFsaWRhdGlvbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgndmFsaWRhdGVGaWxlVXBsb2FkJywgKCkgPT4ge1xuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgc2FmZSBmaWxlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVGaWxlVXBsb2FkKCdkb2N1bWVudC5wZGYnLCAnYXBwbGljYXRpb24vcGRmJywgMTAyNCk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZGFuZ2Vyb3VzIGZpbGUgZXh0ZW5zaW9uJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVGaWxlVXBsb2FkKCdtYWx3YXJlLmV4ZScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oJ0ZpbGUgdHlwZSBub3QgYWxsb3dlZCBmb3Igc2VjdXJpdHkgcmVhc29ucycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgcGF0aCB0cmF2ZXJzYWwgYXR0ZW1wdHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZUZpbGVVcGxvYWQoJy4uLy4uLy4uL2V0Yy9wYXNzd2QnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKCdGaWxlbmFtZSBjb250YWlucyBpbnZhbGlkIHBhdGggY2hhcmFjdGVycycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3Qgb3ZlcnNpemVkIGZpbGVzJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVGaWxlVXBsb2FkKCdsYXJnZS5wZGYnLCAnYXBwbGljYXRpb24vcGRmJywgMjAwICogMTAyNCAqIDEwMjQpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oJ0ZpbGUgc2l6ZSB0b28gbGFyZ2UgKG1heCAxMDQ4NTc2MDAgYnl0ZXMpJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBkaXNhbGxvd2VkIG1pbWV0eXBlJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVGaWxlVXBsb2FkKCdzY3JpcHQuanMnLCAnYXBwbGljYXRpb24vamF2YXNjcmlwdCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0NvbnRhaW4oXCJNaW1ldHlwZSAnYXBwbGljYXRpb24vamF2YXNjcmlwdCcgbm90IGFsbG93ZWRcIik7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCd2YWxpZGF0ZVVybCcsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIEhUVFBTIFVSTCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlVXJsKCdodHRwczovL2V4YW1wbGUuY29tL3dlYmhvb2snKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmVVbmRlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgSFRUUCBVUkwnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZVVybCgnaHR0cDovL2V4YW1wbGUuY29tL3dlYmhvb2snKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IG5vbi1IVFRQIHByb3RvY29scycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlVXJsKCdmdHA6Ly9leGFtcGxlLmNvbS9maWxlJyk7XG4gICAgICBleHBlY3QocmVzdWx0LmlzVmFsaWQpLnRvQmUoZmFsc2UpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5lcnJvcikudG9CZSgnT25seSBIVFRQIGFuZCBIVFRQUyBVUkxzIGFyZSBhbGxvd2VkJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBsb2NhbGhvc3QgVVJMcycsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlVXJsKCdodHRwOi8vbG9jYWxob3N0OjMwMDAvd2ViaG9vaycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5pc1ZhbGlkKS50b0JlKGZhbHNlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmUoJ1ByaXZhdGUgYW5kIGxvY2FsaG9zdCBVUkxzIGFyZSBub3QgYWxsb3dlZCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgcHJpdmF0ZSBJUCBhZGRyZXNzZXMnLCAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZVVybCgnaHR0cDovLzE5Mi4xNjguMS4xL3dlYmhvb2snKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlKCdQcml2YXRlIGFuZCBsb2NhbGhvc3QgVVJMcyBhcmUgbm90IGFsbG93ZWQnKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IGludmFsaWQgVVJMIGZvcm1hdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlVXJsKCdub3QtYS11cmwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yKS50b0JlKCdJbnZhbGlkIFVSTCBmb3JtYXQnKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dlbmVyYXRlU2VjdXJlVG9rZW4nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSB0b2tlbiBvZiBjb3JyZWN0IGxlbmd0aCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHRva2VuID0gZ2VuZXJhdGVTZWN1cmVUb2tlbigxNik7XG4gICAgICBleHBlY3QodG9rZW4pLnRvSGF2ZUxlbmd0aCgzMik7IC8vIDE2IGJ5dGVzID0gMzIgaGV4IGNoYXJzXG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGdlbmVyYXRlIGRpZmZlcmVudCB0b2tlbnMnLCAoKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbjEgPSBnZW5lcmF0ZVNlY3VyZVRva2VuKCk7XG4gICAgICBjb25zdCB0b2tlbjIgPSBnZW5lcmF0ZVNlY3VyZVRva2VuKCk7XG4gICAgICBleHBlY3QodG9rZW4xKS5ub3QudG9CZSh0b2tlbjIpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBnZW5lcmF0ZSBoZXggc3RyaW5nJywgKCkgPT4ge1xuICAgICAgY29uc3QgdG9rZW4gPSBnZW5lcmF0ZVNlY3VyZVRva2VuKCk7XG4gICAgICBleHBlY3QoL15bYS1mMC05XSskLy50ZXN0KHRva2VuKSkudG9CZSh0cnVlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3ZhbGlkYXRlRW52aXJvbm1lbnQnLCAoKSA9PiB7XG4gICAgY29uc3Qgb3JpZ2luYWxFbnYgPSBwcm9jZXNzLmVudjtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYgPSB7IC4uLm9yaWdpbmFsRW52IH07XG4gICAgfSk7XG5cbiAgICBhZnRlckVhY2goKCkgPT4ge1xuICAgICAgcHJvY2Vzcy5lbnYgPSBvcmlnaW5hbEVudjtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgd2l0aCByZXF1aXJlZCBlbnZpcm9ubWVudCB2YXJpYWJsZXMnLCAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5DTElDS1VQX0FQSV9UT0tFTiA9ICdwa18xMjM0NTY3ODkwYWJjZGVmJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlRW52aXJvbm1lbnQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3JzKS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHJlamVjdCBtaXNzaW5nIEFQSSB0b2tlbicsICgpID0+IHtcbiAgICAgIGRlbGV0ZSBwcm9jZXNzLmVudi5DTElDS1VQX0FQSV9UT0tFTjtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlRW52aXJvbm1lbnQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9ycykudG9Db250YWluKCdNaXNzaW5nIHJlcXVpcmVkIGVudmlyb25tZW50IHZhcmlhYmxlOiBDTElDS1VQX0FQSV9UT0tFTicpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgaW52YWxpZCBBUEkgdG9rZW4nLCAoKSA9PiB7XG4gICAgICBwcm9jZXNzLmVudi5DTElDS1VQX0FQSV9UT0tFTiA9ICdpbnZhbGlkJztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHZhbGlkYXRlRW52aXJvbm1lbnQoKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuaXNWYWxpZCkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmVzdWx0LmVycm9yc1swXSkudG9Db250YWluKCdJbnZhbGlkIENMSUNLVVBfQVBJX1RPS0VOJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdyYXRlTGltaXRlcicsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIGFsbG93IHJlcXVlc3RzIHVuZGVyIGxpbWl0JywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0geyB3aW5kb3dNczogNjAwMDAsIG1heFJlcXVlc3RzOiA1IH07XG4gICAgICBcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgNTsgaSsrKSB7XG4gICAgICAgIGV4cGVjdChyYXRlTGltaXRlci5pc0FsbG93ZWQoJ3Rlc3Qta2V5JywgY29uZmlnKSkudG9CZSh0cnVlKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVqZWN0IHJlcXVlc3RzIG92ZXIgbGltaXQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBjb25maWcgPSB7IHdpbmRvd01zOiA2MDAwMCwgbWF4UmVxdWVzdHM6IDIgfTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVyLmlzQWxsb3dlZCgndGVzdC1rZXknLCBjb25maWcpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVyLmlzQWxsb3dlZCgndGVzdC1rZXknLCBjb25maWcpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVyLmlzQWxsb3dlZCgndGVzdC1rZXknLCBjb25maWcpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgcmVzZXQgbGltaXRzIGFmdGVyIHdpbmRvdycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IHsgd2luZG93TXM6IDEwMCwgbWF4UmVxdWVzdHM6IDEgfTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVyLmlzQWxsb3dlZCgndGVzdC1rZXknLCBjb25maWcpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVyLmlzQWxsb3dlZCgndGVzdC1rZXknLCBjb25maWcpKS50b0JlKGZhbHNlKTtcbiAgICAgIFxuICAgICAgLy8gV2FpdCBmb3Igd2luZG93IHRvIGV4cGlyZVxuICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDE1MCkpO1xuICAgICAgXG4gICAgICBleHBlY3QocmF0ZUxpbWl0ZXIuaXNBbGxvd2VkKCd0ZXN0LWtleScsIGNvbmZpZykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBkaWZmZXJlbnQga2V5cyBzZXBhcmF0ZWx5JywgKCkgPT4ge1xuICAgICAgY29uc3QgY29uZmlnID0geyB3aW5kb3dNczogNjAwMDAsIG1heFJlcXVlc3RzOiAxIH07XG4gICAgICBcbiAgICAgIGV4cGVjdChyYXRlTGltaXRlci5pc0FsbG93ZWQoJ2tleTEnLCBjb25maWcpKS50b0JlKHRydWUpO1xuICAgICAgZXhwZWN0KHJhdGVMaW1pdGVyLmlzQWxsb3dlZCgna2V5MicsIGNvbmZpZykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QocmF0ZUxpbWl0ZXIuaXNBbGxvd2VkKCdrZXkxJywgY29uZmlnKSkudG9CZShmYWxzZSk7XG4gICAgICBleHBlY3QocmF0ZUxpbWl0ZXIuaXNBbGxvd2VkKCdrZXkyJywgY29uZmlnKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=